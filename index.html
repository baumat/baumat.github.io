<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lebenslauf - Das Spiel</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://css.gg/css?family=Press+Start+2P" rel="stylesheet">
    <style>
        body {
            font-family: 'Press Start 2P', cursive;
            background-color: #0c0c14;
            color: #ffffff;
            overflow: hidden;
        }
        canvas {
            background-color: #000;
            display: block;
            margin: 0 auto;
            image-rendering: -moz-crisp-edges;
            image-rendering: -webkit-crisp-edges;
            image-rendering: pixelated;
            image-rendering: crisp-edges;
        }
        #gameContainer {
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            width: 100vw;
            height: 100vh;
            background: #0f172a;
        }
        #startButton {
            background-color: #38bdf8;
            border: 10px solid #facc15;
            padding: 1.5rem 3rem;
            color: #ffffff;
            cursor: pointer;
            text-shadow: 4px 4px #0c4a6e;
            box-shadow: 0px 10px 0px #eab308;
            text-transform: uppercase;
            transition: all 0.1s ease-in-out;
            font-size: 4rem;
            line-height: 1;
        }
        #startButton:hover {
            background-color: #7dd3fc;
            box-shadow: 0px 6px 0px #eab308;
            transform: translateY(4px);
        }
        #startSubtitle {
            margin-top: 2rem;
            color: #cbd5e1;
            font-size: 1rem;
            text-shadow: 2px 2px #020617;
        }
    </style>
</head>
<body class="flex items-center justify-center h-screen m-0">

    <div id="gameContainer">
        <button id="startButton">Start</button>
        <p id="startSubtitle">Press start to begin your adventure!</p>
        <canvas id="gameCanvas" class="hidden"></canvas>
    </div>

    <script>
        const gameContainer = document.getElementById('gameContainer');
        const startButton = document.getElementById('startButton');
        const startSubtitle = document.getElementById('startSubtitle');
        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');

        // --- Globale Spiel-Variablen ---
        let gameState = 'start';
        let passedScreenTimer = 0;
        const PASSED_SCREEN_DURATION = 180;

        let loadingProgress = 0;
        let studiumBanner = { x: 0, y: 0, width: 0, height: 0 };
        let player = {
            x: 150, y: 550, width: 48, height: 88, speed: 4, direction: 'front',
            colors: {
                skin:   { base: '#f5c6a7', shadow: '#e4a883' },
                hair:   { base: '#4a3f35', shadow: '#302923', highlight: '#6a5a4a' },
                shirt:  { base: '#0077b6', shadow: '#005a8d' },
                pants:  { base: '#03045e', shadow: '#01023a' },
                shoes:  { base: '#555555', shadow: '#333333' },
                backpack: { base: '#780000', shadow: '#540000'}
            }
        };
        const keys = { ArrowRight: false, ArrowLeft: false, ArrowUp: false, ArrowDown: false };

        // --- Spiel Konfiguration ---
        const GAME_WIDTH = 1280;
        const GAME_HEIGHT = 720;
        canvas.width = GAME_WIDTH;
        canvas.height = GAME_HEIGHT;
      
        // --- Minispiel 2: DNA-Sequenzierung ---
        let dnaSequence = [];
        let currentDnaIndex = 0;
        const sequenceLength = 8;
        
        const npcs = [
             { x: 250, y: 560, colors: { skin: { base: '#e7a977', shadow: '#d19260' }, hair: { base: '#2a9d8f', shadow: '#1e6f66', highlight: '#3bc1b2' }, shirt: { base: '#ff9f1c', shadow: '#e0870c' }, pants: { base: '#264653', shadow: '#1b323b' }, shoes: { base: '#54382c', shadow: '#3b271e' }, backpack: { base: '#2a9d8f', shadow: '#1e6f66'} } },
            { x: 450, y: 555, colors: { skin: { base: '#f4a261', shadow: '#d6884a' }, hair: { base: '#e76f51', shadow: '#c4553a', highlight: '#f08f76' }, shirt: { base: '#e9c46a', shadow: '#c9a552' }, pants: { base: '#264653', shadow: '#1b323b' }, shoes: { base: '#54382c', shadow: '#3b271e' }, backpack: { base: '#e76f51', shadow: '#c4553a'} } },
            { x: 800, y: 565, colors: { skin: { base: '#d8b2a1', shadow: '#bc9683' }, hair: { base: '#023047', shadow: '#011c2b', highlight: '#034566' }, shirt: { base: '#8ecae6', shadow: '#6ca9c4' }, pants: { base: '#023047', shadow: '#011c2b' }, shoes: { base: '#54382c', shadow: '#3b271e' }, backpack: { base: '#023047', shadow: '#011c2b'} } },
            { x: 950, y: 550, colors: { skin: { base: '#c792f5', shadow: '#a974d6' }, hair: { base: '#9b5de5', shadow: '#7d41c4', highlight: '#b983f2' }, shirt: { base: '#f15bb5', shadow: '#d04398' }, pants: { base: '#3c096c', shadow: '#2a064c' }, shoes: { base: '#54382c', shadow: '#3b271e' }, backpack: { base: '#f15bb5', shadow: '#d04398'} } },
        ];

        const floorTiles = [];
        function createFloorTexture() { for(let i = 0; i < 50; i++){ floorTiles.push({ x: Math.random() * GAME_WIDTH, y: 600 + Math.random() * 120, size: 4 + Math.random() * 8, opacity: 0.5 + Math.random() * 0.5 }); } }
        createFloorTexture();

        // --- Hilfsfunktionen ---
        function drawPixelText(text, x, y, color, size) { ctx.fillStyle = color; ctx.font = `${size}px 'Press Start 2P'`; ctx.shadowColor = "rgba(0,0,0,0.7)"; ctx.shadowOffsetX = 3; ctx.shadowOffsetY = 3; ctx.fillText(text, x, y); ctx.shadowColor = "transparent"; }
        
        // --- Spiel Setup Funktionen ---
        function setupDnaMinigame() { dnaSequence = []; currentDnaIndex = 0; const bases = ['A', 'T', 'C', 'G']; const pairs = { 'A': 'T', 'T': 'A', 'C': 'G', 'G': 'C' }; for (let i = 0; i < sequenceLength; i++) { const base = bases[Math.floor(Math.random() * bases.length)]; dnaSequence.push({ base: base, pair: pairs[base], userPair: null }); } }
        
        // --- Zeichnen der Haupt-Szenen ---
        function drawLoadingScreen() { ctx.fillStyle = '#0c0c14'; ctx.fillRect(0, 0, GAME_WIDTH, GAME_HEIGHT); drawPixelText('Loading...', GAME_WIDTH / 2 - 200, GAME_HEIGHT / 2 - 40, '#fff', 32); ctx.strokeStyle = '#fff'; ctx.strokeRect(GAME_WIDTH / 2 - 250, GAME_HEIGHT / 2, 500, 50); ctx.fillStyle = '#3a86ff'; ctx.fillRect(GAME_WIDTH / 2 - 250, GAME_HEIGHT / 2, loadingProgress * 5, 50); loadingProgress++; if (loadingProgress > 100) gameState = 'abifeier'; }
        
        function drawAbifeierScene() {
            ctx.imageSmoothingEnabled = false; const sky = ctx.createLinearGradient(0, 0, 0, GAME_HEIGHT); sky.addColorStop(0, '#8ecae6'); sky.addColorStop(1, '#bde0fe'); ctx.fillStyle = sky; ctx.fillRect(0, 0, GAME_WIDTH, GAME_HEIGHT); ctx.fillStyle = 'rgba(255, 255, 255, 0.9)'; ctx.fillRect(100, 120, 150, 40); ctx.fillRect(120, 100, 110, 60); ctx.fillRect(600, 80, 200, 50); ctx.fillRect(630, 60, 140, 70); ctx.fillRect(1000, 150, 180, 45); ctx.fillRect(1020, 130, 140, 65); ctx.fillStyle = '#d6ccc2'; ctx.fillRect(100, 250, GAME_WIDTH - 200, 350);
            ctx.fillStyle = '#54382c'; ctx.fillRect(620, 450, 100, 150);
            ctx.fillStyle = '#3c2a1e'; ctx.fillRect(625, 455, 90, 140);
            drawPixelText('Gymnasium', 550, 220, '#1d3557', 32);
            ctx.fillStyle = '#b0a69a'; ctx.fillRect(80, 230, GAME_WIDTH - 160, 40); for (let i = 0; i < 6; i++) { ctx.fillStyle = '#415a77'; ctx.fillRect(180 + i * 150, 300, 90, 120); ctx.fillStyle = '#778da9'; ctx.fillRect(185 + i * 150, 305, 80, 110); } ctx.fillStyle = '#a9a9a9'; ctx.fillRect(0, 600, GAME_WIDTH, 120); floorTiles.forEach(tile => { ctx.fillStyle = `rgba(141, 141, 141, ${tile.opacity})`; ctx.fillRect(tile.x, tile.y, tile.size, tile.size); }); const bannerX = GAME_WIDTH / 2 - 250, bannerY = 150; ctx.fillStyle = '#e63946'; ctx.fillRect(bannerX - 20, bannerY, 20, 250); ctx.fillRect(bannerX + 500, bannerY, 20, 250); ctx.fillStyle = '#f1faee'; ctx.fillRect(bannerX, bannerY, 500, 80); drawPixelText('ABIFEIER', bannerX + 110, bannerY + 55, '#1d3557', 30); const balloonColors = ['#ffbe0b', '#fb5607', '#ff006e', '#8338ec', '#3a86ff']; for (let i = 0; i < 7; i++) { const x = 150 + i * 160, y = 350 + Math.sin(Date.now() / 600 + i) * 15;
                ctx.strokeStyle = '#aaaaaa'; ctx.lineWidth = 2; ctx.beginPath(); ctx.moveTo(x, y); ctx.lineTo(x + Math.sin(Date.now() / 800 + i) * 10, 600); ctx.stroke();
                ctx.fillStyle = balloonColors[i % 5]; ctx.beginPath(); ctx.arc(x, y, 40, 0, Math.PI * 2); ctx.fill(); ctx.fillStyle = 'rgba(255,255,255,0.5)'; ctx.beginPath(); ctx.arc(x - 10, y - 10, 10, 0, Math.PI * 2); ctx.fill(); } studiumBanner = {x: GAME_WIDTH - 320, y: 520, width: 280, height: 70}; ctx.fillStyle = '#52b788'; ctx.fillRect(studiumBanner.x, studiumBanner.y, studiumBanner.width, studiumBanner.height); drawPixelText('-> Studium', studiumBanner.x + 20, studiumBanner.y + 48, '#fff', 20); drawPixelText('Bewege dich zum Studium-Banner!', 250, 680, '#fff', 16);
        }

        // --- ÜBERARBEITETE ZEICHENFUNKTION ---
        function drawCharacter(x, y, colors, direction = 'front') {
            const bobOffset = Math.sin(Date.now() / 250 + x) * 2;
            y += bobOffset;
            const w = 4;
            ctx.save();
            if (direction === 'left') {
                ctx.translate(x + (w*11), y);
                ctx.scale(-1, 1);
                x=0; y=0;
            }

            if (direction === 'front') {
                ctx.fillStyle = colors.backpack.shadow; ctx.fillRect(x, y + w * 5, w * 12, w * 8);
                ctx.fillStyle = colors.backpack.base; ctx.fillRect(x + w, y + w * 5, w * 10, w * 8);
                ctx.fillStyle = colors.shoes.shadow; ctx.fillRect(x + w, y + w * 21, w * 3, w); ctx.fillRect(x + w * 7, y + w * 21, w * 3, w);
                ctx.fillStyle = colors.shoes.base; ctx.fillRect(x + w * 2, y + w * 21, w, w); ctx.fillRect(x + w * 8, y + w * 21, w, w);
                ctx.fillStyle = colors.pants.shadow; ctx.fillRect(x + w, y + w * 14, w * 3, w * 7); ctx.fillRect(x + w * 7, y + w * 14, w * 3, w * 7);
                ctx.fillStyle = colors.pants.base; ctx.fillRect(x + w, y + w * 14, w * 2, w * 7); ctx.fillRect(x + w * 7, y + w * 14, w * 2, w * 7);
                ctx.fillStyle = colors.shirt.shadow; ctx.fillRect(x, y + w * 7, w * 11, w * 7);
                ctx.fillStyle = colors.shirt.base; ctx.fillRect(x + w, y + w * 7, w * 9, w * 7);
                ctx.fillStyle = colors.skin.shadow; ctx.fillRect(x - w, y + w * 13, w, w); ctx.fillRect(x + w * 11, y + w * 13, w, w);
                ctx.fillStyle = colors.shirt.shadow; ctx.fillRect(x - w, y + w * 8, w, w * 5); ctx.fillRect(x + w * 11, y + w * 8, w, w * 5);
                ctx.fillStyle = colors.skin.base; ctx.fillRect(x, y + w * 13, w, w); ctx.fillRect(x + w * 10, y + w * 13, w, w);
                ctx.fillStyle = colors.shirt.base; ctx.fillRect(x, y + w * 8, w, w * 5); ctx.fillRect(x + w * 10, y + w * 8, w, w * 5);
                ctx.fillStyle = colors.skin.shadow; ctx.fillRect(x + w*2, y + w, w*7, w*6);
                ctx.fillStyle = colors.skin.base; ctx.fillRect(x + w*2, y + w, w*6, w*5);
                
                // NEUE, DETAILLIERTERE FRISUR (Vorderansicht)
                ctx.fillStyle = colors.hair.shadow;
                ctx.fillRect(x+w, y, w, w*2); ctx.fillRect(x+w*9, y, w, w*2); // Seiten
                ctx.fillRect(x+w*2, y+w*4, w*7, w); // Unterseite
                ctx.fillRect(x+w*4, y, w*3, w); // Oberseite
                ctx.fillStyle = colors.hair.base;
                ctx.fillRect(x+w*2, y, w*7, w*3); // Hauptblock
                ctx.fillRect(x+w, y+w*2, w, w*2); ctx.fillRect(x+w*9, y+w*2, w, w*2); // Seitensträhnen
                ctx.fillRect(x+w*3, y+w*3, w, w); ctx.fillRect(x+w*7, y+w*3, w, w); // Pony
                ctx.fillStyle = colors.hair.highlight;
                ctx.fillRect(x+w*4, y, w*4, w); ctx.fillRect(x+w*5, y+w, w*2, w);

                ctx.fillStyle = '#ffffff'; ctx.fillRect(x + w * 3, y + w * 3, w, w); ctx.fillRect(x + w * 7, y + w * 3, w, w);
            } else { // Seitenansicht
                ctx.fillStyle = colors.backpack.shadow; ctx.fillRect(x - w*2, y + w * 7, w * 5, w * 8);
                ctx.fillStyle = colors.backpack.base; ctx.fillRect(x - w, y + w * 7, w * 4, w * 8);
                ctx.fillStyle = colors.shoes.shadow; ctx.fillRect(x + w * 2, y + w * 21, w*3, w);
                ctx.fillStyle = colors.shoes.base; ctx.fillRect(x + w * 3, y + w * 21, w, w);
                ctx.fillStyle = colors.pants.shadow; ctx.fillRect(x + w * 2, y + w * 14, w*3, w*7);
                ctx.fillStyle = colors.pants.base; ctx.fillRect(x + w * 2, y + w * 14, w*2, w*7);
                ctx.fillStyle = colors.skin.shadow; ctx.fillRect(x + w * 4, y + w * 13, w, w);
                ctx.fillStyle = colors.shirt.shadow; ctx.fillRect(x + w * 4, y + w * 8, w, w * 5);
                ctx.fillStyle = colors.skin.base; ctx.fillRect(x + w * 5, y + w * 13, w, w);
                ctx.fillStyle = colors.shirt.base; ctx.fillRect(x + w * 5, y + w * 8, w, w * 5);
                ctx.fillStyle = colors.shirt.shadow; ctx.fillRect(x + w, y + w * 7, w * 4, w * 7);
                ctx.fillStyle = colors.shirt.base; ctx.fillRect(x + w * 2, y + w * 7, w * 2, w * 7);
                ctx.fillStyle = colors.skin.shadow; ctx.fillRect(x + w*3, y + w, w*5, w*6);
                ctx.fillStyle = colors.skin.base; ctx.fillRect(x + w*3, y + w, w*4, w*5);

                // NEUE, DETAILLIERTERE FRISUR (Seitenansicht)
                ctx.fillStyle = colors.hair.shadow;
                ctx.fillRect(x+w*2, y, w*6, w); // Oben
                ctx.fillRect(x+w, y+w, w*2, w*3); // Hinten
                ctx.fillRect(x+w*7, y+w, w, w*3); // Vorne
                ctx.fillStyle = colors.hair.base;
                ctx.fillRect(x+w*3, y+w, w*4, w*4); // Hauptteil
                ctx.fillRect(x+w*7, y+w*2, w, w*2); // Pony
                ctx.fillStyle = colors.hair.highlight;
                ctx.fillRect(x+w*4, y+w, w*3, w);

                ctx.fillStyle = '#ffffff'; ctx.fillRect(x + w * 6, y + w * 3, w, w);
            }
            ctx.restore();
        }
        function drawPlayer() { drawCharacter(player.x, player.y, player.colors, player.direction); }
        function drawNPCs() { npcs.forEach(npc => drawCharacter(npc.x, npc.y, npc.colors, 'front')); }
        function drawLevelPassedScene() { ctx.fillStyle = 'rgba(0, 0, 0, 0.7)'; ctx.fillRect(0, 0, GAME_WIDTH, GAME_HEIGHT); drawPixelText('Bestanden!', GAME_WIDTH / 2 - 250, GAME_HEIGHT / 2, '#52b788', 48); }
        function drawEndScene() { ctx.fillStyle = '#0c0c14'; ctx.fillRect(0, 0, GAME_WIDTH, GAME_HEIGHT); drawPixelText('Studium erfolgreich', 200, 300, '#ffbe0b', 32); drawPixelText('abgeschlossen!', 300, 400, '#ffbe0b', 32); }

        // --- DNA Minispiel: Update & Draw ---
        function handleDnaInput(key) { if (gameState !== 'dna_minigame' || currentDnaIndex >= sequenceLength) return; const expectedPair = dnaSequence[currentDnaIndex].pair; if (key.toUpperCase() === expectedPair) { dnaSequence[currentDnaIndex].userPair = key.toUpperCase(); currentDnaIndex++; if (currentDnaIndex >= sequenceLength) { gameState = 'level_passed'; passedScreenTimer = 0; } } else { currentDnaIndex = 0; dnaSequence.forEach(s => s.userPair = null); } }
        function drawDnaMinigame() { ctx.fillStyle = '#1d3557'; ctx.fillRect(0, 0, GAME_WIDTH, GAME_HEIGHT); drawPixelText('Minispiel: DNA-Sequenzierung', 150, 80, '#fff', 24); drawPixelText('Vervollstaendige die Sequenz (A-T, G-C)', 100, 120, '#ddd', 16); const startX = 200, startY = 300, spacing = 100, baseSize = 40; for (let i = 0; i < sequenceLength; i++) { const x = startX + i * spacing; drawPixelText(dnaSequence[i].base, x, startY, '#8ecae6', 24); ctx.fillStyle = '#457b9d'; ctx.fillRect(x, startY + 20, baseSize / 2, 5); ctx.fillRect(x, startY + 80, baseSize / 2, 5); ctx.fillRect(x + (baseSize/4), startY + 20, 5, 65); const displayPair = dnaSequence[i].userPair || '?'; const color = i === currentDnaIndex ? '#ffbe0b' : '#8ecae6'; drawPixelText(displayPair, x, startY + 120, color, 24); } }
        
        // --- Update & Kollision ---
        function updatePlayerPosition() {
             let moved = false;
             if (keys.ArrowRight) { player.x += player.speed; player.direction = 'right'; moved = true; } 
             else if (keys.ArrowLeft) { player.x -= player.speed; player.direction = 'left'; moved = true; }
             if (keys.ArrowUp) { player.y -= player.speed; moved = true; } 
             else if (keys.ArrowDown) { player.y += player.speed; moved = true; }
             if (!moved && !keys.ArrowLeft && !keys.ArrowRight) { player.direction = 'front'; }
             if (player.x < 0) player.x = 0; if (player.x + player.width > GAME_WIDTH) player.x = GAME_WIDTH - player.width;
             if (player.y < 520) player.y = 520; if (player.y + player.height > GAME_HEIGHT) player.y = GAME_HEIGHT - player.height;
        }
        function checkCollision(rect1, rect2) { const rect1Right = rect1.x + rect1.width; const rect1Bottom = rect1.y + rect1.height; const rect2Right = rect2.x + (rect2.width || rect2.size); const rect2Bottom = rect2.y + (rect2.height || rect2.size); return rect1.x < rect2Right && rect1Right > rect2.x && rect1.y < rect2Bottom && rect1Bottom > rect2.y; }
        
        // --- Haupt-Game-Loop ---
        function gameLoop() {
            ctx.clearRect(0, 0, GAME_WIDTH, GAME_HEIGHT);
            switch (gameState) {
                case 'loading': drawLoadingScreen(); break;
                case 'abifeier':
                    updatePlayerPosition(); drawAbifeierScene(); drawNPCs(); drawPlayer();
                    if (checkCollision(player, studiumBanner)) {
                        gameState = 'dna_minigame'; setupDnaMinigame();
                    }
                    break;
                case 'dna_minigame': drawDnaMinigame(); break;
                case 'level_passed':
                    drawLevelPassedScene(); passedScreenTimer++;
                    if(passedScreenTimer > PASSED_SCREEN_DURATION) {
                        passedScreenTimer = 0;
                        gameState = 'end_scene';
                    }
                    break;
                case 'end_scene': drawEndScene(); break;
            }
            requestAnimationFrame(gameLoop);
        }

        // --- Event Listeners ---
        startButton.addEventListener('click', () => { gameContainer.style.flexDirection = 'row'; startButton.classList.add('hidden'); startSubtitle.classList.add('hidden'); canvas.classList.remove('hidden'); gameState = 'loading'; gameLoop(); });
        window.addEventListener('keydown', (e) => { 
            if (keys.hasOwnProperty(e.key)) { e.preventDefault(); keys[e.key] = true; } 
            if (gameState === 'dna_minigame' && ['a', 't', 'c', 'g'].includes(e.key.toLowerCase())) { handleDnaInput(e.key); } 
        });
        window.addEventListener('keyup', (e) => { if (keys.hasOwnProperty(e.key)) { e.preventDefault(); keys[e.key] = false; } });
    </script>
</body>
</html>

